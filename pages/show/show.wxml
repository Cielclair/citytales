<!--pages/show/show.wxml-->
<view wx:if="{{!user.id}}" class="login-field">
  <button class="login-btn" type="primary" open-type="getUserInfo" bindgetuserinfo="loginWithWechat">点击登陆</button>
</view>
<view class="top-section">
  <image  class = "avatar" mode = "aspectFill" src = "{{story.avatar}}" />
  <view class="h1">{{story.nickname}}</view>
  <view wx:if="{{userStory.liked}}" class="icon-card" bindtap="unlikeUserStory">
    <image class="icon" src="/images/like_red.png"></image>
  </view>
  <view wx:else class="icon-card" bindtap="likeUserStory">
    <image class="icon" src="/images/like.png"></image>
  </view>
  <view wx:if="{{userStory.saved}}" class="icon-card" bindtap="unsaveUserStory">
    <image class="icon" src="/images/想看.png"></image>
  </view>
  <view wx:else class="icon-card" bindtap="saveUserStory">
    <image class="icon" src="/images/已想看.png"></image>
  </view>
</view>

<view class="story-img" style="background-image:url('{{story.image}}')"></view>

<view class="page__header">
  <view class="story-title">{{story.title}}</view>
  <view class="story-date">{{story.posted_date}}</view>
</view>

<view class="page__content">
  <text class="story-content">{{story.content}}</text>
  <view class="story-location">
    <image class="location-icon" src='../../images/地点.png'></image>
    <view class="location" bindtap="openLocation">{{story.address}}</view>
    <button id="delete-btn" wx:if="{{story.created_by === user.id}}" type="warn" bindtap="deleteStory">删除城事</button>
  </view>
</view>

<view class="comments_section">
  <view class = "comments_input">
    <input class="content" style="width: 100%; height: 100%" placeholder-class="place-holder" value="{{content}}" placeholder="写下你的评论" data-type="content" bindinput = "onChangeContent">
    </input>
    <button style="width: 100%" type="primary" form-type="submit" bindtap="commentStory">发表
    </button>
  </view>
  <view wx:for="{{comments}}" class = "comments_display" >
    <image class = "avatar" mode = "aspectFill" src = "{{item.avatar}}" />
    <view>{{item.content}}</view>
    <view wx:if="{{item.liked}}" class="icon-card" data-id="{{item.id}}" data-likes="{{item.likes}}" bindtap="unlikeComment">
      <image class="icon" src="/images/like_red.png"></image>
      <text>{{item.likes}}</text>
    </view>
    <view wx:else class="icon-card" data-id="{{item.id}}" data-likes="{{item.likes}}" bindtap="likeComment">
      <image class="icon" src="/images/like.png"></image>
      <text>{{item.likes}}</text>
    </view>
  </view>
</view>


